<mat-expansion-panel>
    <mat-expansion-panel-header>
        <mat-panel-title>
            Tasks
        </mat-panel-title>
        <mat-panel-description>
            <!--      <span *ngIf="tasks && tasks.length > 0 else noTasksLabel"> This phases contains {{ tasks.length }} task(s)</span>-->
            <ng-template #noTasksLabel>
                <span>This phase has no tasks</span>
            </ng-template>
            @if (tasksHasErrors) {
                <div class="panel-description-error">
                    <mat-icon color="warn">error_outline</mat-icon>
                    <mat-error>There are errors in some tasks</mat-error>
                </div>
            }
        </mat-panel-description>
    </mat-expansion-panel-header>

    <sentinel-controls
        [controls]="controls">
    </sentinel-controls>
    <mat-divider />

    @if ((stepperTasks | async).length > 0) {
        <div>
            <crczp-task-stepper (activeStepChange)="onActiveTaskChanged($event)"
                                (phaseMove)="onTaskMoved($event)"
                                [activeStep]="activeStep$ | async"
                                [tasks]="stepperTasks | async">
            </crczp-task-stepper>
            <mat-divider />
            <!--    <ng-template>AdaptiveRunVisualization {{ selectedStep + 1 }}</ng-template>-->
            <div class="step-content">
                <crczp-task-configuration (taskChange)="onTaskChanged($event)"
                                          [task]="$any((stepperTasks | async)[activeStep$ | async].phase)">
                </crczp-task-configuration>
            </div>
        </div>
    } @else {
        <h3>There are no Tasks</h3>
    }
    <div>
    </div>
</mat-expansion-panel>
