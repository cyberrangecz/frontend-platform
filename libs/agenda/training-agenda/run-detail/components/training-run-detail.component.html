<div class="header">
    <!-- LEVEL STEPPER -->
    @if (isStepperDisplayed && stepper?.items) {
        <div class="training-run-stepper round-scrollbar">
            <sentinel-stepper
                (indexSelected)="activeStepChanged($event)"
                [activeIndex]="stepper.activeLevelIndex"
                [draggable]="false"
                [selectable]="backwardMode"
                [stepperItems]="stepper"
            >
            </sentinel-stepper>
        </div>
    }
</div>

@if (activeLevel$ | async; as activeLevel) {
    <!-- CONTENT OF ACTIVE LEVEL -->
    <crczp-abstract-level
        (next)="next()"
        [hidden]="(backtrackedLevel$ | async) && activeLevel.id !== stepper.items[stepper.activeLevelIndex].id"
        [isBacktracked]="false"
        [isLast]="isLast"
        [isLevelAnswered]="isCurrentLevelAnswered$ | async"
        [isStepperDisplayed]="isStepperDisplayed"
        [level]="activeLevel"
        [localEnvironment]="localEnvironment"
        [sandboxDefinitionId]="sandboxDefinitionId"
        [sandboxInstanceId]="sandboxInstanceId"
        [startTime]="startTime"
    />
    @if ((backtrackedLevel$ | async) && activeLevel.id !== stepper.items[stepper.activeLevelIndex].id) {
        <crczp-abstract-level
            (next)="this.activeStepChanged(this.stepper.activeLevelIndex + 1)"
            [isBacktracked]="true"
            [isLast]="isLast"
            [isStepperDisplayed]="isStepperDisplayed"
            [level]="backtrackedLevel$ | async"
            [localEnvironment]="localEnvironment"
            [sandboxDefinitionId]="sandboxDefinitionId"
            [sandboxInstanceId]="sandboxInstanceId"
            [startTime]="startTime"
        />
    }
}

