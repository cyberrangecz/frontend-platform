<div class="container">
    <div #levelContentElement class="level-content {{isStepperDisplayed ?
      'content-height-with-stepper' :
      'content-height-without-stepper'}}">
        @if (window.innerWidth > 1400) {
            @if (!(isCollapsed())) {
                <div #left class="left-panel round-scrollbar">
                    {{ levelContent }}
                </div>

                <div #right class="right-panel">
                    <button (click)="isCollapsed.set(!isCollapsed())" class="collapse-button">
                        <mat-icon>
                            chevron_right
                        </mat-icon>
                    </button>
                    <crczp-topology-wrapper
                        (getAccessFile)="getAccessFile.emit($event)"
                        [id]="{instanceId: sandboxInstanceId}"
                        [levelLoading]="isLoading | async"
                        class="wh-100 overflow-hidden"
                    />
                </div>
            } @else {
                <div #left class="left-panel left-panel--full round-scrollbar">
                    {{ levelContent }}
                </div>
                <button (click)="isCollapsed.set(!isCollapsed())" class="collapse-button collapse-button--collapsed">
                    <mat-icon>
                        chevron_left
                    </mat-icon>
                </button>
            }
        } @else {
            <div #left class="left-panel round-scrollbar">
                {{ levelContent }}
            </div>

            <div #right class="right-panel">
                <crczp-topology-wrapper
                    (getAccessFile)="getAccessFile.emit($event)"
                    [id]="{instanceId: sandboxInstanceId}"
                    [levelLoading]="isLoading | async"
                    class="wh-100 overflow-hidden"
                />
            </div>
        }

    </div>
    @if ((isLoading | async) === false) {
        @if ((isCorrectAnswerSubmitted$ | async) || isBacktracked) {
            <button
                (click)="next.emit()"
                class="next-button"
                mat-raised-button>
                {{ isLast && !isBacktracked ? "Finish" : "Next" }}
            </button>
        } @else {
            <crczp-floating-answer-form
                (answerSubmit)="answerSubmitted.emit($event)"
                [buttonLabel]="isLast ? 'Finish' : 'Submit'"
            >
                @if (hints) {
                    <ng-container [ngTemplateOutlet]="hints" />
                }
            </crczp-floating-answer-form>
        }
    }
</div>

